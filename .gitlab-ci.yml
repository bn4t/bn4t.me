stages:
  - pages
  - purge_cache


pages:
  stage: pages
  variables:
    GIT_SUBMODULE_STRATEGY: recursive
  image: registry.gitlab.com/pages/hugo:latest
  script:
    - git submodule update --init --recursive
    - hugo
  artifacts:
    paths:
    - public
  only:
  - master


# purge cloudflare cache
purge_cache:
  image: appropriate/curl:latest
  stage: purge_cache
  script:
    - sh gitlab-ci/purge_cache.sh
  only:
    - master


